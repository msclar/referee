python src/finetune_referee_control.py --model_type gpt2-large --filter_dataset_based_on_nli --batch_size 3 --n_epochs 2 --custom_model_name gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step1_two_epochs --bucket_structure_id tenway_bucket --min_samples_per_class_in_rebalanced_dataset 5000 --dataset_paths data/source-sentences/realnews_100k/realnews_s1_chunk_2.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_2.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_3.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_3.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_4.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_4.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_100.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_100.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_101.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_101.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_102.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_102.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_103.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_103.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_104.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_104.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_105.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_105.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_106.txt,summaries_gpt3_curie_realnews_100k/summaries_chunk_106.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_5.txt,generated-datasets/step_1_nli_nepochs_5_compression_0.3/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_5.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_6.txt,generated-datasets/step_1_nli_nepochs_5_compression_0.3/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_6.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_7.txt,generated-datasets/step_1_nli_nepochs_5_compression_0.3/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_7.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_8.txt,generated-datasets/step_1_nli_nepochs_5_compression_0.3/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_8.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_9.txt,generated-datasets/step_2_nli_nepochs_5_compression_0.5/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_9.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_10.txt,generated-datasets/step_2_nli_nepochs_5_compression_0.5/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_10.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_11.txt,generated-datasets/step_2_nli_nepochs_5_compression_0.5/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_11.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_12.txt,generated-datasets/step_2_nli_nepochs_5_compression_0.5/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_12.txt

for i in 1,2,17,18 ; do IFS=","; set -- $i; ( python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 0,9 --device "cuda:0" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 1,8 --device "cuda:1" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 2,7 --device "cuda:2" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 3,6 --device "cuda:3" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 4,5 --device "cuda:4" ) && wait ; done

for i in 1,2,17,18 ; do IFS=","; set -- $i; python src/finetune_referee_control.py --model_type gpt2-large --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid  --filter_dataset_based_on_nli --filter_based_on_fluency --fluency_ratio_boundary 1.0  --batch_size 2 --n_epochs 2 --min_samples_per_class_in_rebalanced_dataset 3000 --custom_model_name gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs --dataset_paths data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.0-0.1.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.1-0.2.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.2-0.3.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.3-0.4.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.4-0.5.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.5-0.6.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.6-0.7.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.7-0.8.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.8-0.9.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.9-1.0.txt  && \
( python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 0,9 --device "cuda:0" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 1,8 --device "cuda:1" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 2,7 --device "cuda:2" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 3,6 --device "cuda:3" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 4,5 --device "cuda:4" ) && wait ; done

for i in 2,3,18,19 3,4,19,20 4,5,20,21 5,6,21,22 6,7,22,23 ; do IFS=","; set -- $i; python src/finetune_referee_control.py --model_type gpt2-large --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0  --filter_dataset_based_on_nli --filter_based_on_fluency --fluency_ratio_boundary 1.0  --batch_size 2 --n_epochs 2 --min_samples_per_class_in_rebalanced_dataset 3000 --custom_model_name gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs --dataset_paths data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.0-0.1.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.1-0.2.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.2-0.3.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.3-0.4.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.4-0.5.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.5-0.6.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.6-0.7.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.7-0.8.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.8-0.9.txt,data/source-sentences/realnews_100k/realnews_s1_chunk_$3.txt,generated-datasets/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$1_two_epochs_repeatbucketid_fluencyfilter_1.0/p\=None-temp\=None-k\=None-reppen\=1.0-nbeams-5/summaries_chunk_$3_compression_range_0.9-1.0.txt && \
( python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 0,9 --device "cuda:0" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 1,8 --device "cuda:1" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 2,7 --device "cuda:2" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 3,6 --device "cuda:3" & \
python src/generate_summaries_referee_control.py --finetuned_model_path finetuned-models/referee-control/gpt2-large_control_code_tenway_bucket_chunks_2_16_100_106_step$2_two_epochs_repeatbucketid_fluencyfilter_1.0/ --n_beams 5 --min_chunk_id $4 --max_chunk_id $4 --enumerated_bucket_ids 4,5 --device "cuda:4" ) && wait ; done
